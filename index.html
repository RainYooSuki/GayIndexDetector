<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GayæŒ‡æ•°æ£€æµ‹å™¨</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒˆ</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- å¼•å…¥ Bootstrap Icons ç”¨äº GitHub å›¾æ ‡ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Roboto', sans-serif;
            /* --- å¢å¼ºçš„åŠ¨æ€èƒŒæ™¯ --- */
            background: linear-gradient(-45deg, #f0f4f8, #e6f7ff, #f5f0ff, #e8f5e9);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            /* --- ç»“æŸå¢å¼ºçš„èƒŒæ™¯ --- */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden; /* é˜²æ­¢åŠ¨ç”»å¯¼è‡´æ°´å¹³æ»šåŠ¨ */
        }

        /* --- å¢å¼ºçš„èƒŒæ™¯åŠ¨ç”» --- */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        /* --- ç»“æŸå¢å¼ºçš„èƒŒæ™¯åŠ¨ç”» --- */

        /* --- å¢å¼ºçš„è¯­è¨€åˆ‡æ¢æŒ‰é’®åŠ¨ç”» --- */
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.85); /* ç¨å¾®æé«˜ä¸é€æ˜åº¦ä»¥å¢å¼ºå¯è§æ€§ */
            border: none;
            border-radius: 16px; /* ç¨å¾®æ›´åœ†æ¶¦ */
            padding: 10px 18px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* æ›´å¹³æ»‘ã€æ›´æœ‰å¼¹æ€§çš„è¿‡æ¸¡ */
            backdrop-filter: blur(5px); /* å¾®å¦™çš„æ¯›ç»ç’ƒæ•ˆæœ */
        }
        .language-toggle:hover {
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transform: translateY(-3px) scale(1.05); /* æ‚¬åœæ—¶ç¨å¾®æ”¾å¤§ */
        }
        .language-toggle:active {
             transform: translateY(-1px) scale(0.98); /* è½»å¾®çš„æŒ‰ä¸‹æ•ˆæœ */
        }
        /* --- ç»“æŸå¢å¼ºçš„è¯­è¨€åˆ‡æ¢ --- */

        /* --- å¢å¼ºçš„ GitHub é“¾æ¥åŠ¨ç”» --- */
        .github-link {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: #333;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 100;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* æ›´å¹³æ»‘ã€æ›´æœ‰å¼¹æ€§çš„è¿‡æ¸¡ */
            backdrop-filter: blur(2px); /* ä¸€è‡´çš„æ¯›ç»ç’ƒæ•ˆæœ */
        }
        .github-link:hover {
            transform: translateY(-8px) scale(1.15); /* æ›´æ˜æ˜¾çš„æå‡å’Œç¼©æ”¾ */
            background: #000;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        .github-link:active {
             transform: translateY(-4px) scale(1.08); /* è½»å¾®çš„æŒ‰ä¸‹æ•ˆæœ */
        }
        .github-link .bi {
            color: white;
            font-size: 24px;
            transition: transform 0.3s ease; /* å›¾æ ‡æ—‹è½¬æ•ˆæœ */
        }
        .github-link:hover .bi {
            transform: rotate(30deg); /* æ‚¬åœæ—¶æ—‹è½¬å›¾æ ‡ */
        }
        /* --- ç»“æŸå¢å¼ºçš„ GitHub é“¾æ¥ --- */

        /* --- å¢å¼ºçš„ä¸»å®¹å™¨åŠ¨ç”» --- */
        .container {
            width: 100%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.92); /* ç¨å¾®é€æ˜ */
            border-radius: 28px; /* ç¨å¾®æ›´åœ†æ¶¦ */
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards; /* å…¥åœºåŠ¨ç”» */
            backdrop-filter: blur(10px); /* æ¯›ç»ç’ƒæ•ˆæœ */
            border: 1px solid rgba(255, 255, 255, 0.5); /* å¾®å¦™çš„è¾¹æ¡† */
        }
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* --- ç»“æŸå¢å¼ºçš„å®¹å™¨ --- */

        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 35px 24px; /* ç¨å¾®å¢åŠ å†…è¾¹è· */
            text-align: center;
        }
        .header h1 {
            font-weight: 500;
            font-size: 28px;
            margin-bottom: 8px;
        }
        .header p {
            font-weight: 300;
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            padding: 35px; /* ç¨å¾®å¢åŠ å†…è¾¹è· */
        }

        .input-group {
            margin-bottom: 30px;
        }
        .input-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 500;
            color: #333;
            font-size: 16px;
        }

        /* --- å¢å¼ºçš„è¾“å…¥æ¡†åŠ¨ç”» --- */
        .input-wrapper {
            position: relative;
        }
        .input-wrapper input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); /* æ›´å¹³æ»‘çš„é»˜è®¤è¿‡æ¸¡ */
            outline: none;
            background-color: rgba(255, 255, 255, 0.7); /* ç¨å¾®é€æ˜çš„èƒŒæ™¯ */
        }
        .input-wrapper input:focus {
            border-color: #6a11cb;
            box-shadow: 0 0 0 4px rgba(106, 17, 203, 0.2); /* æ›´æŸ”å’Œçš„ç„¦ç‚¹å…‰æ™• */
            background-color: rgba(255, 255, 255, 1); /* ç„¦ç‚¹æ—¶ä¸ºçº¯è‰²èƒŒæ™¯ */
        }
        /* ç„¦ç‚¹æ—¶æ·»åŠ å¾®å¦™çš„è„‰å†²åŠ¨ç”» */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(106, 17, 203, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(106, 17, 203, 0); }
            100% { box-shadow: 0 0 0 0 rgba(106, 17, 203, 0); }
        }
        .input-wrapper input:focus {
            animation: pulse 1s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .input-wrapper .material-icons {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #757575;
            transition: color 0.3s ease, transform 0.3s ease; /* å›¾æ ‡è¿‡æ¸¡ */
        }
        .input-wrapper input:focus + .material-icons {
            color: #6a11cb;
            transform: translateY(-50%) scale(1.2); /* ç„¦ç‚¹æ—¶ç¨å¾®æ”¾å¤§å›¾æ ‡ */
        }
        /* --- ç»“æŸå¢å¼ºçš„è¾“å…¥æ¡† --- */

        /* --- å¢å¼ºçš„æŒ‰é’®åŠ¨ç”» --- */
        .btn {
            display: block;
            width: 100%;
            padding: 16px;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* æ›´å¹³æ»‘ã€æ›´æœ‰å¼¹æ€§ */
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        .btn:hover {
            transform: translateY(-3px) scale(1.02); /* æå‡å’Œè½»å¾®ç¼©æ”¾ */
            box-shadow: 0 7px 20px rgba(37, 117, 252, 0.4);
        }
        .btn:hover::before {
            width: 300px;
            height: 300px;
        }
        .btn:active {
            transform: translateY(-1px) scale(0.98); /* è½»å¾®çš„æŒ‰ä¸‹æ•ˆæœ */
        }
        /* --- ç»“æŸå¢å¼ºçš„æŒ‰é’® --- */

        /* --- ä¿®æ”¹ç»“æœå®¹å™¨åŠ¨ç”»ï¼Œå®ç°åŠ¨æ€é«˜åº¦è°ƒæ•´ --- */
        .result-container {
            /* --- å…³é”®ï¼šåˆå§‹çŠ¶æ€ä¸å ç”¨å¸ƒå±€ç©ºé—´ --- */
            opacity: 0;
            max-height: 0; /* åˆå§‹æœ€å¤§é«˜åº¦ä¸º0 */
            padding: 0 35px; /* å·¦å³paddingä¿ç•™ï¼Œä¸Šä¸‹paddingè®¾ä¸º0 */
            margin-top: 0; /* é¡¶éƒ¨å¤–è¾¹è·è®¾ä¸º0 */
            margin-bottom: 0; /* åº•éƒ¨å¤–è¾¹è·è®¾ä¸º0 */
            overflow: hidden; /* éšè—æº¢å‡ºå†…å®¹ */
            /* --- å…³é”®ï¼šè¿‡æ¸¡åŠ¨ç”» --- */
            transition: opacity 0.5s ease-out 0.2s,
                        max-height 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s,
                        padding 0.5s ease-out 0.2s,
                        margin 0.5s ease-out 0.2s;
        }

        /* --- å®šä¹‰æ˜¾ç¤ºçŠ¶æ€çš„ç±» --- */
        .result-container.show {
            opacity: 1;
            max-height: 800px; /* è®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å€¼ï¼Œç¡®ä¿å†…å®¹èƒ½å®Œå…¨å±•å¼€ */
            padding: 35px; /* æ¢å¤æ­£å¸¸çš„ä¸Šä¸‹å†…è¾¹è· */
            margin-top: 30px; /* æ¢å¤é¡¶éƒ¨å¤–è¾¹è· */
            margin-bottom: 30px; /* æ¢å¤åº•éƒ¨å¤–è¾¹è· */
        }
        /* --- ç»“æŸä¿®æ”¹çš„ç»“æœå®¹å™¨ --- */

        .result-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .result-header h2 {
            font-weight: 500;
            font-size: 20px;
            color: #333;
        }
        .score {
            font-weight: 700;
            font-size: 24px;
            color: #6a11cb;
            /* --- å¢å¼ºçš„åˆ†æ•°åŠ¨ç”» --- */
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), color 0.3s ease;
        }
        .score.updated {
             animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            70% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        /* --- ç»“æŸå¢å¼ºçš„åˆ†æ•° --- */

        .progress-container {
            height: 24px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 24px;
            position: relative;
        }
        /* --- å¢å¼ºçš„è¿›åº¦æ¡åŠ¨ç”» --- */
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            border-radius: 12px;
            width: 0%;
            /* ä¸ºè¿›åº¦ä½¿ç”¨æ›´åŠ¨æ€çš„ç¼“åŠ¨å‡½æ•° */
            transition: width 2s cubic-bezier(0.22, 0.61, 0.36, 1); /* æ›´é•¿çš„æŒç»­æ—¶é—´ï¼Œæ›´å¹³æ»‘çš„æ›²çº¿ */
            position: relative;
        }
        /* ä¸ºè¿›åº¦æ¡æ·»åŠ å¾®å¦™çš„å…‰æ³½æ•ˆæœ */
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shine 2s infinite;
        }
        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        /* --- ç»“æŸå¢å¼ºçš„è¿›åº¦æ¡ --- */

        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #757575;
            margin-top: 8px;
        }

        /* --- ä¿®æ”¹è¯„ä»·å’Œå½©è™¹åŒºåŸŸï¼Œä½¿å…¶èƒ½åŠ¨æ€è°ƒæ•´å®¹å™¨å¤§å° --- */
        .evaluation, .rainbow {
            background: #f5f7ff; /* ç»™ rainbow ä¹ŸåŠ ä¸ŠèƒŒæ™¯è‰²ä¿æŒä¸€è‡´ */
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-top: 20px; /* ç»Ÿä¸€ä½¿ç”¨ margin-top æ§åˆ¶é—´è· */
            /* --- å…³é”®ï¼šåˆå§‹çŠ¶æ€ä¸å ç”¨ç©ºé—´ --- */
            opacity: 0;
            transform: scaleY(0.8); /* å‚ç›´å‹ç¼© */
            height: 0;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            margin-bottom: 0;
            overflow: hidden;
            /* --- å…³é”®ï¼šè¿‡æ¸¡åŠ¨ç”» --- */
            /* ä½¿ç”¨ä¸åŒçš„å»¶è¿Ÿè®© Evaluation å…ˆå‡ºç°ï¼ŒRainbow åå‡ºç° */
            transition: opacity 0.4s ease-out,
                        transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1),
                        height 0.4s ease-out,
                        padding 0.4s ease-out,
                        margin 0.4s ease-out;
        }

        /* --- ä¸º rainbow å•ç‹¬è®¾ç½®æ ·å¼ï¼Œå› ä¸ºå®ƒåˆå§‹æ˜¯ display: none --- */
        .rainbow {
            background: linear-gradient(90deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080);
            background-size: 1200% 100%;
            animation: rainbow 15s linear infinite;
            color: white;
            font-weight: 500;
            display: none; /* åˆå§‹éšè— */
            /* å•ç‹¬çš„è¿‡æ¸¡ï¼Œç”¨äºæ˜¾ç¤º/éšè— */
            transition: opacity 0.5s ease-out 0.2s, /* å»¶è¿Ÿæ·¡å…¥ */
                        transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) 0.2s,
                        height 0.5s ease-out 0.2s,
                        padding 0.5s ease-out 0.2s,
                        margin 0.5s ease-out 0.2s,
                        display 0.5s ease-out; /* æ§åˆ¶ display å˜åŒ– */
        }
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        /* --- æ˜¾ç¤ºçŠ¶æ€çš„ç±» --- */
        .evaluation.show, .rainbow.show {
            opacity: 1;
            transform: scaleY(1); /* æ¢å¤åŸçŠ¶ */
            height: auto; /* æ¢å¤è‡ªåŠ¨é«˜åº¦ */
            padding: 20px; /* æ¢å¤å†…è¾¹è· */
            margin-top: 20px; /* æ¢å¤å¤–è¾¹è· */
            overflow: visible;
        }
        /* å¯¹äº rainbowï¼Œshow æ—¶éœ€è¦ display: block */
        .rainbow.show {
            display: block;
        }

        /* --- è¯„ä»·åŒºåŸŸå†…éƒ¨æ ·å¼å¾®è°ƒ --- */
        .evaluation h3 {
            font-weight: 500;
            margin-bottom: 12px;
            color: #333;
            /* ç¡®ä¿æ ‡é¢˜å’Œæ®µè½ä¹Ÿæœ‰è¿‡æ¸¡æ•ˆæœï¼Œä½¿å…¶éšå®¹å™¨ä¸€èµ·å‡ºç° */
            transition: inherit;
        }
        .evaluation p {
            color: #666;
            line-height: 1.6;
            transition: inherit;
        }
        /* --- ç»“æŸä¿®æ”¹è¯„ä»·å’Œå½©è™¹åŒºåŸŸ --- */

        .stage-indicator {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
        }
        /* --- å¢å¼ºçš„é˜¶æ®µæŒ‡ç¤ºå™¨åŠ¨ç”» --- */
        .stage {
            width: 18%;
            text-align: center;
            padding: 8px 0;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* æ›´å¹³æ»‘çš„è¿‡æ¸¡ */
            background-color: #eeeeee; /* é»˜è®¤èƒŒæ™¯ */
            color: #757575; /* é»˜è®¤æ–‡æœ¬é¢œè‰² */
            transform: scale(0.9);
        }
        .stage.active {
            background: linear-gradient(135deg, #6a11cb, #2575fc); /* æ¸å˜èƒŒæ™¯ */
            color: white;
            font-weight: bold;
            transform: scale(1.05); /* æ¿€æ´»æ—¶ç¨å¾®æ”¾å¤§ */
            box-shadow: 0 4px 10px rgba(106, 17, 203, 0.3); /* ä¸ºæ¿€æ´»é˜¶æ®µæ·»åŠ é˜´å½± */
        }
        /* --- ç»“æŸå¢å¼ºçš„é˜¶æ®µ --- */

        @media (max-width: 600px) {
            .container {
                border-radius: 24px; /* ä¸ºå°å±å¹•è°ƒæ•´ */
            }
            .header {
                padding: 28px 20px; /* è°ƒæ•´å†…è¾¹è· */
            }
            .content {
                padding: 28px; /* è°ƒæ•´å†…è¾¹è· */
            }
            .language-toggle {
                top: 15px;
                right: 15px;
                padding: 8px 16px;
                border-radius: 12px; /* è°ƒæ•´è¾¹æ¡†åŠå¾„ */
            }
            .github-link {
                bottom: 15px;
                right: 15px;
                width: 45px;
                height: 45px;
            }
        }
    </style>
</head>
<body>
    <!-- ä¿®æ”¹åçš„ä¸­è‹±æ–‡åˆ‡æ¢æŒ‰é’® -->
    <button id="languageToggle" class="language-toggle">EN</button>
    <!-- ä½¿ç”¨æ–°çš„ GitHub å›¾æ ‡ -->
    <a href="https://github.com/RainYooSuki/GayIndexDetector" target="_blank" class="github-link">
        <i class="bi bi-github"></i>
    </a>
    <div class="container">
        <div class="header">
            <h1 id="pageTitle">GayæŒ‡æ•°æ£€æµ‹å™¨</h1>
            <p id="pageSubtitle">è¾“å…¥åå­—ï¼Œçœ‹çœ‹ä½ çš„GayæŒ‡æ•°æœ‰å¤šé«˜</p>
        </div>
        <div class="content">
            <div class="input-group">
                <label for="userName" id="inputLabel">è¯·è¾“å…¥ä½ çš„åå­—</label>
                <div class="input-wrapper">
                    <input type="text" id="userName" placeholder="">
                    <span class="material-icons">person</span>
                </div>
            </div>
            <button id="calculateBtn" class="btn">æ£€æµ‹æˆ‘çš„GayæŒ‡æ•°</button>
            <div class="result-container" id="resultContainer">
                <div class="result-header">
                    <h2 id="resultTitle">æ£€æµ‹ç»“æœ</h2>
                    <div class="score" id="scoreDisplay">0</div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-labels">
                    <span id="label0">0 (ç›´ç”·)</span>
                    <span>20</span>
                    <span>40</span>
                    <span>60</span>
                    <span>80</span>
                    <span id="label100">100 (ç»ˆæGay)</span>
                </div>
                <div class="stage-indicator">
                    <div class="stage" data-stage="0">0-20</div>
                    <div class="stage" data-stage="1">21-40</div>
                    <div class="stage" data-stage="2">41-60</div>
                    <div class="stage" data-stage="3">61-80</div>
                    <div class="stage" data-stage="4">81-100</div>
                </div>
                <div class="evaluation">
                    <h3 id="evaluationTitle">è¯„ä»·</h3>
                    <p id="evaluationText">è¯·è¾“å…¥åå­—å¼€å§‹æ£€æµ‹</p>
                </div>
                <div class="rainbow" id="rainbowMessage">
                    æ­å–œä½ è§£é”äº†ç»ˆæGayæ¨¡å¼ï¼ğŸŒˆ
                </div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // è¯­è¨€åˆ‡æ¢ç›¸å…³å…ƒç´ 
            const languageToggle = document.getElementById('languageToggle');
            const pageTitle = document.getElementById('pageTitle');
            const pageSubtitle = document.getElementById('pageSubtitle');
            const inputLabel = document.getElementById('inputLabel');
            const calculateBtn = document.getElementById('calculateBtn');
            const resultTitle = document.getElementById('resultTitle');
            const label0 = document.getElementById('label0');
            const label100 = document.getElementById('label100');
            const evaluationTitle = document.getElementById('evaluationTitle');
            const evaluationText = document.getElementById('evaluationText');
            const rainbowMessage = document.getElementById('rainbowMessage');
            // ç”¨æˆ·è¾“å…¥ç›¸å…³å…ƒç´ 
            const userName = document.getElementById('userName');
            const resultContainer = document.getElementById('resultContainer');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const progressBar = document.getElementById('progressBar');
            const stages = document.querySelectorAll('.stage');
            const evaluationDiv = document.querySelector('.evaluation'); // æ·»åŠ å¼•ç”¨
            // å½“å‰è¯­è¨€çŠ¶æ€ (0: ä¸­æ–‡, 1: è‹±æ–‡)
            let currentLanguage = 0;
            // è¯­è¨€æ–‡æœ¬æ˜ å°„
            const languageTexts = {
                pageTitle: ["GayæŒ‡æ•°æ£€æµ‹å™¨", "Gay Index Detector"],
                pageSubtitle: ["è¾“å…¥åå­—ï¼Œçœ‹çœ‹ä½ çš„GayæŒ‡æ•°æœ‰å¤šé«˜", "Enter your name to see how gay you are"],
                inputLabel: ["è¯·è¾“å…¥ä½ çš„åå­—", "Please enter your name"],
                calculateBtn: ["æ£€æµ‹æˆ‘çš„GayæŒ‡æ•°", "Detect My Gay Index"],
                resultTitle: ["æ£€æµ‹ç»“æœ", "Detection Result"],
                label0: ["0 (ç›´ç”·)", "0 (Straight)"],
                label100: ["100 (ç»ˆæGay)", "100 (Ultimate Gay)"],
                evaluationTitle: ["è¯„ä»·", "Evaluation"],
                evaluationText: ["è¯·è¾“å…¥åå­—å¼€å§‹æ£€æµ‹", "Please enter your name to start detection"],
                rainbowMessage: ["æ­å–œä½ è§£é”äº†ç»ˆæGayæ¨¡å¼ï¼ğŸŒˆ", "Congratulations on unlocking Ultimate Gay mode! ğŸŒˆ"],
                stage0: ["0-20", "0-20"],
                stage1: ["21-40", "21-40"],
                stage2: ["41-60", "41-60"],
                stage3: ["61-80", "61-80"],
                stage4: ["81-100", "81-100"]
            };
            // é˜¶æ®µè¯„ä»·æ˜ å°„ï¼ˆä¸­è‹±æ–‡ï¼‰
            const stageEvaluations = [
                { 
                    title: ["é’¢é“ç›´ç”·", "Steel Straight"],
                    text: [
                        "æ­å–œä½ ï¼ä½ çš„åå­—æ•£å‘ç€çº¯æ­£çš„ç›´ç”·æ°”æ¯ï¼Œè¿é£éƒ½ä¸ºä½ å¹åäº†æ–¹å‘ã€‚",
                        "Congratulations! Your name radiates pure straight energy. Even the wind changes direction for you."
                    ]
                },
                { 
                    title: ["ç–‘ä¼¼Gay", "Suspected Gay"],
                    text: [
                        "ä½ çš„åå­—é€éœ²å‡ºä¸€ä¸ä¸å¯»å¸¸çš„æ°”æ¯ï¼Œå»ºè®®æ£€æŸ¥ä¸€ä¸‹è¡£æ©±é‡Œæ˜¯ä¸æ˜¯æ··å…¥äº†åˆ«äººçš„è¡£æœã€‚",
                        "Your name reveals a hint of unusual energy. We suggest checking if someone else's clothes got mixed in your closet."
                    ]
                },
                { 
                    title: ["åŠç³–Gay", "Half-Sugar Gay"],
                    text: [
                        "ä½ çš„åå­—å¸¦æœ‰æ˜æ˜¾çš„Gayå±æ€§ï¼Œä½†è¿˜å¤„äºå¯æ§åˆ¶èŒƒå›´å†…ã€‚å»ºè®®å¤šå–çƒ­æ°´ï¼Œä¿æŒå†·é™ã€‚",
                        "Your name clearly has Gay attributes, but it's still within control. Drink more hot water and stay calm."
                    ]
                },
                { 
                    title: ["èµ„æ·±Gay", "Senior Gay"],
                    text: [
                        "å“‡å“¦ï¼ä½ çš„åå­—ç®€ç›´å°±æ˜¯Gayç•Œçš„æ ‡æ†ï¼Œå»ºè®®ç”³è¯·å‰å°¼æ–¯ä¸–ç•Œçºªå½•ã€‚",
                        "Wow! Your name is a benchmark in the Gay world. Consider applying for a Guinness World Record."
                    ]
                },
                { 
                    title: ["ç»ˆæGay", "Ultimate Gay"],
                    text: [
                        "å¤©å“ªï¼ä½ çš„åå­—å……æ»¡äº†Gayçš„ç»ˆæå¥¥ä¹‰ï¼Œè¿å½©è™¹éƒ½ä¸ºä½ æ„Ÿåˆ°éª„å‚²ï¼",
                        "Oh my! Your name is filled with the ultimate Gay essence. Even the rainbow is proud of you!"
                    ]
                }
            ];
            // --- æ–°å¢ï¼šä¸€ä¸ªç®€å•çš„åŸºäºå­—ç¬¦ä¸²çš„â€œå“ˆå¸Œâ€å‡½æ•° ---
            // ç›®çš„ï¼šä¸ºç›¸åŒçš„å­—ç¬¦ä¸²äº§ç”Ÿç›¸åŒçš„â€œä¼ªéšæœºâ€æ•°ï¼Œä¸åŒå­—ç¬¦ä¸²äº§ç”Ÿä¸åŒçš„æ•°
            function simpleHash(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char; // hash * 31 + char
                    hash = hash & hash; // è½¬æ¢ä¸º 32 ä½æ•´æ•°
                }
                return Math.abs(hash); // è¿”å›éè´Ÿæ•°
            }
            // è®¡ç®—åˆ†æ•°çš„å‡½æ•°ï¼ˆè°ƒæ•´ç‰ˆï¼Œå®ç°å¯æ­£å¯è´Ÿçš„é•¿åº¦å› å­å’Œæ¦‚ç‡æ€§èŒƒå›´æ˜ å°„ï¼‰
            function calculateScore(name) {
                if (!name) return 0;
                let score = 0;
                let hasNonEnglishChar = false;
                // æ£€æŸ¥æ˜¯å¦åŒ…å«éè‹±æ–‡å­—ç¬¦ï¼Œå¹¶ä¸ºæ¯ä¸ªéè‹±æ–‡å­—ç¬¦æä¾›åŸºç¡€åŠ åˆ†
                for (let char of name) {
                    const codePoint = char.codePointAt(0);
                    if (!((codePoint >= 65 && codePoint <= 90) || (codePoint >= 97 && codePoint <= 122))) {
                        hasNonEnglishChar = true;
                        score += 5; // åŸºç¡€åŠ åˆ†
                    }
                }
                // --- ä¿®æ”¹ï¼šå¯æ­£å¯è´Ÿçš„é•¿åº¦å› å­ ---
                let lengthComponent = name.length * 4; // åŸºç¡€é•¿åº¦åˆ†
                if (hasNonEnglishChar) {
                    lengthComponent *= 1.1; // éè‹±æ–‡å­—ç¬¦é•¿åº¦åˆ†åŠ æˆ
                }
                // å†³å®šé•¿åº¦å› å­æ­£è´Ÿï¼šä½¿ç”¨å­—ç¬¦ä¸²å“ˆå¸Œå€¼çš„å¥‡å¶æ€§
                const hashForSign = simpleHash(name);
                const isLengthPositive = (hashForSign % 2 === 0); // å¶æ•°ä¸ºæ­£ï¼Œå¥‡æ•°ä¸ºè´Ÿ
                const lengthBonus = isLengthPositive ? lengthComponent : -lengthComponent * 0.5; // è´Ÿå‘å½±å“å‡åŠ
                score += Math.min(Math.abs(lengthBonus) * (isLengthPositive ? 1 : 0.5), 45); // åº”ç”¨é•¿åº¦åˆ†ï¼Œè´Ÿå‘å½±å“æ›´å°ä¸”æœ‰ä¸Šé™
                // å…¶ä»–åŠ åˆ†é¡¹ä¿æŒä¸å˜æˆ–å¾®è°ƒ
                const vowels = name.match(/[aeiouAEIOU]/g);
                if (vowels) {
                    score += Math.min(vowels.length * 3, 25);
                }
                const specialChars = name.match(/[yYlLrRsS]/g);
                if (specialChars) {
                    score += Math.min(specialChars.length * 4, 18);
                }
                if (name.toLowerCase().includes('gay')) {
                    score += 25;
                }
                // --- ä¿®æ”¹ï¼šåŸºäºå†…å®¹çš„æ¦‚ç‡æ€§èŒƒå›´æ˜ å°„ ---
                if (score <= 0) return 0; // å¦‚æœåŸºç¡€åˆ†éæ­£ï¼Œç›´æ¥è¿”å›0
                // 1. ä½¿ç”¨å“ˆå¸Œå€¼å†³å®šç›®æ ‡åŒºé—´
                const hashForRange = simpleHash(name + "range"); // ä½¿ç”¨ä¸åŒç§å­é¿å…å†²çª
                const rangeIndex = hashForRange % 5; // 0 to 4
                const ranges = [
                    { min: 0, max: 20 },
                    { min: 21, max: 40 },
                    { min: 41, max: 60 },
                    { min: 61, max: 80 },
                    { min: 81, max: 100 }
                ];
                const targetRange = ranges[rangeIndex];
                // 2. å°†åŸå§‹åˆ†æ•°æ˜ å°„åˆ°ç›®æ ‡åŒºé—´
                // é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œå‚è€ƒåˆ†æ•°â€æ¥å†³å®šå¦‚ä½•æ˜ å°„ã€‚
                // è¿™é‡Œæˆ‘ä»¬ç®€å•åœ°ä½¿ç”¨ score æœ¬èº«ä½œä¸ºå‚è€ƒï¼Œä½†å¯ä»¥è¿›è¡Œä¸€äº›å˜æ¢ä½¿å…¶æ›´å¹³æ»‘ã€‚
                // ä¾‹å¦‚ï¼Œå¯ä»¥å…ˆå¯¹å…¶è¿›è¡Œå¯¹æ•°å‹ç¼©ï¼š refScore = Math.log10(score + 1) * 10;
                let refScore = Math.log10(score + 1) * 15; // å¯¹åŸå§‹å¾—åˆ†è¿›è¡Œå‹ç¼©
                // ä¸ºäº†å¢åŠ ç¦»æ•£åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥å¦ä¸€ä¸ªåŸºäºå“ˆå¸Œçš„æ‰°åŠ¨å› å­
                const hashForPerturbation = simpleHash(name + "perturb");
                const perturbationFactor = 0.9 + ((hashForPerturbation % 1000003) / 1000003) * 0.2; // 0.9 to 1.1
                refScore *= perturbationFactor;
                // å°† refScore (ç†è®ºä¸Šå¯ä»¥æ˜¯ä»»æ„æ­£æ•°) æ˜ å°„åˆ° 0-100 çš„æ€»èŒƒå›´å†…ï¼Œç„¶åçœ‹å®ƒè½åœ¨å“ªä¸ªéƒ¨åˆ†
                // ä¸€ç§æ–¹æ³•æ˜¯å°†å…¶å¯¹ 100 å–æ¨¡ï¼Œä½†è¿™å¯èƒ½ä¸å¤Ÿå¹³æ»‘ã€‚
                // æ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Sigmoid å‡½æ•°æˆ–ç›´æ¥çº¿æ€§æ˜ å°„ï¼Œä½†æˆ‘ä»¬å·²ç»å†³å®šäº†ç›®æ ‡åŒºé—´ã€‚
                // æ‰€ä»¥ï¼Œæˆ‘ä»¬å°† refScore æ˜ å°„åˆ° 0-1 çš„èŒƒå›´ï¼Œç„¶åæ˜ å°„åˆ°ç›®æ ‡åŒºé—´çš„å…·ä½“åˆ†æ•°ã€‚
                // ç®€åŒ–å¤„ç†ï¼šå°† refScore é€šè¿‡ä¸€ä¸ªå‡½æ•°å‹ç¼©åˆ° 0-100ï¼Œç„¶åçœ‹å®ƒè‡ªç„¶è½åœ¨å“ªä¸ªåŒºé—´
                // ä½†å› ä¸ºæˆ‘ä»¬å·²ç»æŒ‡å®šäº†ç›®æ ‡åŒºé—´ï¼Œæˆ‘ä»¬ç›´æ¥å°† refScore æ˜ å°„åˆ°è¯¥åŒºé—´ã€‚
                // ä¸ºäº†ä½¿æ˜ å°„æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬å‡è®¾ refScore æœ‰ä¸€ä¸ªå¤§è‡´çš„èŒƒå›´ï¼ˆæ¯”å¦‚ 0-50ï¼‰
                // æˆ‘ä»¬å¯ä»¥å°†å…¶è£å‰ªå¹¶çº¿æ€§æ˜ å°„åˆ°ç›®æ ‡åŒºé—´
                const clampedRefScore = Math.min(Math.max(refScore, 0), 50); // å‡è®¾ refScore é€šå¸¸åœ¨ 0-50
                const mappedScore = targetRange.min + (clampedRefScore / 50) * (targetRange.max - targetRange.min);
                // 3. ä¸ºäº†è¿›ä¸€æ­¥å¢åŠ éè‹±æ–‡åå­—çš„ç¦»æ•£åº¦ï¼Œå¯ä»¥å¯¹åŒ…å«éè‹±æ–‡å­—ç¬¦çš„åå­—æ–½åŠ é¢å¤–çš„æ˜ å°„æ‰°åŠ¨
                let finalScore = mappedScore;
                if (hasNonEnglishChar) {
                     const hashForFinalTweak = simpleHash(name + "final");
                     const tweakFactor = 0.95 + ((hashForFinalTweak % 1000003) / 1000003) * 0.1; // 0.95 to 1.05
                     finalScore = mappedScore * tweakFactor;
                }
                // 4. ç¡®ä¿æœ€ç»ˆåˆ†æ•°åœ¨ 0-100 ä¹‹é—´
                return Math.min(Math.max(Math.floor(finalScore), 0), 100);
            }
            // åˆ‡æ¢è¯­è¨€å‡½æ•°
            function toggleLanguage() {
                currentLanguage = 1 - currentLanguage;
                // æ›´æ–°æŒ‰é’®æ–‡æœ¬
                languageToggle.textContent = currentLanguage === 0 ? 'EN' : 'ä¸­æ–‡';
                // æ›´æ–°æ‰€æœ‰æ–‡æœ¬
                pageTitle.textContent = languageTexts.pageTitle[currentLanguage];
                pageSubtitle.textContent = languageTexts.pageSubtitle[currentLanguage];
                inputLabel.textContent = languageTexts.inputLabel[currentLanguage];
                calculateBtn.textContent = languageTexts.calculateBtn[currentLanguage];
                resultTitle.textContent = languageTexts.resultTitle[currentLanguage];
                label0.textContent = languageTexts.label0[currentLanguage];
                label100.textContent = languageTexts.label100[currentLanguage];
                evaluationTitle.textContent = languageTexts.evaluationTitle[currentLanguage];
                // å¦‚æœç»“æœæ˜¾ç¤ºäº†ï¼Œæ›´æ–°è¯„ä»·
                if (resultContainer.classList.contains('show')) { // æ£€æŸ¥ 'show' ç±»è€Œä¸æ˜¯ display æ ·å¼
                    const score = parseInt(scoreDisplay.textContent);
                    const stage = Math.floor(score / 20);
                    evaluationText.textContent = stageEvaluations[stage].text[currentLanguage];
                    evaluationTitle.textContent = stageEvaluations[stage].title[currentLanguage];
                } else {
                    evaluationText.textContent = languageTexts.evaluationText[currentLanguage];
                }
                // æ›´æ–°é˜¶æ®µæ ‡ç­¾
                stages[0].textContent = languageTexts.stage0[currentLanguage];
                stages[1].textContent = languageTexts.stage1[currentLanguage];
                stages[2].textContent = languageTexts.stage2[currentLanguage];
                stages[3].textContent = languageTexts.stage3[currentLanguage];
                stages[4].textContent = languageTexts.stage4[currentLanguage];
                // æ›´æ–°å½©è™¹æ¶ˆæ¯
                rainbowMessage.textContent = languageTexts.rainbowMessage[currentLanguage];
            }
            // æ›´æ–°è¿›åº¦æ¡å’Œè¯„ä»·
            function updateDisplay(score) {
                // æ›´æ–°åˆ†æ•°æ˜¾ç¤ºåŠ¨ç”»
                scoreDisplay.classList.remove('updated');
                void scoreDisplay.offsetWidth; // è§¦å‘å›æµ
                scoreDisplay.textContent = score;
                scoreDisplay.classList.add('updated');

                // æ›´æ–°è¿›åº¦æ¡
                progressBar.style.width = score + '%';

                // ç¡®å®šé˜¶æ®µ
                const stage = Math.floor(score / 20);

                // æ›´æ–°è¯„ä»· (å¸¦æœ‰å»¶è¿Ÿä»¥å®ç°æ›´å¹³æ»‘çš„åºåˆ—)
                setTimeout(() => {
                    evaluationTitle.textContent = stageEvaluations[stage].title[currentLanguage];
                    evaluationText.textContent = stageEvaluations[stage].text[currentLanguage];
                    evaluationDiv.classList.add('show'); // è§¦å‘è¯„ä»·æ·¡å…¥
                }, 300); // ç¨å¾®å»¶è¿Ÿè¯„ä»·æ–‡æœ¬æ›´æ–°

                // æ›´æ–°é˜¶æ®µæŒ‡ç¤ºå™¨
                stages.forEach((el, index) => {
                    if (index === stage) {
                        el.classList.add('active');
                    } else {
                        el.classList.remove('active');
                    }
                });

                // --- ä¿®æ”¹ï¼šå¤„ç†å½©è™¹æ¶ˆæ¯ (ä½¿ç”¨åŠ¨ç”»å’ŒåŠ¨æ€é«˜åº¦) ---
                if (score >= 80) {
                   // å»¶è¿Ÿæ˜¾ç¤ºå½©è™¹æ¶ˆæ¯ï¼Œä½¿å…¶åœ¨è¯„ä»·ä¹‹åå‡ºç°
                   setTimeout(() => {
                       rainbowMessage.classList.add('show'); // è§¦å‘å½©è™¹åŒºåŸŸæ·¡å…¥ã€å±•å¼€å’Œ display å˜åŒ–
                   }, 600); // æ¯”è¯„ä»·åŠ¨ç”»ç¨æ™šä¸€ç‚¹
                } else {
                    // å¦‚æœåˆ†æ•°ä¸å¤Ÿï¼Œç¡®ä¿å½©è™¹æ¶ˆæ¯éšè—
                    rainbowMessage.classList.remove('show');
                }
                // --- ç»“æŸä¿®æ”¹ ---
            }

            // è®¡ç®—æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            calculateBtn.addEventListener('click', function() {
                const name = userName.value.trim();
                if (!name) {
                    alert(currentLanguage === 0 ? 'è¯·è¾“å…¥ä½ çš„åå­—' : 'Please enter your name');
                    return;
                }
                // --- ä¿®æ”¹ï¼šæ˜¾ç¤ºç»“æœå®¹å™¨åŠ¨ç”» ---
                // ç§»é™¤ä¹‹å‰çš„ show ç±»ä»¥é‡ç½®åŠ¨ç”»
                resultContainer.classList.remove('show');
                // è§¦å‘é‡æ’ (reflow) ä»¥ç¡®ä¿ç§»é™¤ç±»ç”Ÿæ•ˆ
                void resultContainer.offsetWidth;
                // æ·»åŠ  show ç±»è§¦å‘åŠ¨ç”»
                resultContainer.classList.add('show');
                // --- ç»“æŸä¿®æ”¹ ---

                // é‡ç½® previous elements for animation replay (å¦‚æœä¹‹å‰æœ‰å®ç°)
                // ... (é‡ç½®åˆ†æ•°ã€è¿›åº¦æ¡ã€é˜¶æ®µæŒ‡ç¤ºå™¨ç­‰çš„åŠ¨ç”»ç±») ...
                // ä¾‹å¦‚ï¼š
                scoreDisplay.classList.remove('updated');
                progressBar.style.width = '0%';
                stages.forEach(s => s.classList.remove('active'));
                evaluationDiv.classList.remove('show');
                rainbowMessage.classList.remove('show');

                // è®¡ç®—åˆ†æ•° (ä½¿ç”¨æ–°ç®—æ³•)
                const score = calculateScore(name);

                // å»¶è¿Ÿæ›´æ–°ä»¥æ˜¾ç¤ºåŠ¨ç”»æ•ˆæœ
                setTimeout(() => {
                    updateDisplay(score);
                }, 100); // è¿™ä¸ªå»¶è¿Ÿå¯ä»¥ä¸å®¹å™¨å‡ºç°åŠ¨ç”»é…åˆ
            });

            // å›è½¦é”®è§¦å‘è®¡ç®—
            userName.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculateBtn.click();
                }
            });

            // è¯­è¨€åˆ‡æ¢æŒ‰é’®äº‹ä»¶
            languageToggle.addEventListener('click', toggleLanguage);
        });
    </script>
</body>
</html>